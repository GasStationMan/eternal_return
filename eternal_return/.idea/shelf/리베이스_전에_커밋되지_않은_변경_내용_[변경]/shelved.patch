Index: ../improved_mcfunction/project/eternal_return/entity/animal/alpha/behav.mcfunction
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>#  틱에 따른 행동 알고리즘\r\n#  +-----------+--------------------------------+\r\n#  |TIME_STAMP |           Behave               |\r\n#  +-----------+--------------------------------+\r\n#  |-61t..     | - Attack() or Move()           |\r\n#  |-1..61t    | - Skill_ready()                |\r\n#  |-1t        | - Do_skill()                   |\r\n#  |-..0t      | - skillCool := skillCool + 80t |\r\n#  +-----------+--------------------------------+\r\n\r\n#  +---------------+--------------------------------------------------------------------------------------------+\r\n#  |    VAR_NAME   |                                     VAR_INFO                                               |\r\n#  +---------------+--------------------------------------------------------------------------------------------+\r\n#  | isMotionExist | - this.root에 모션이 있는지 없는지 판단해주는 bool                                            |   \r\n#  | Animal_info   | - {animal : \"alpha\", OPTdistance : 20, damage : 5, attackTick : 12, attackDistance : 5}    |\r\n#  +---------------+--------------------------------------------------------------------------------------------+\r\n\r\n\r\nentity  modelEntity         is      @e[type=minecraft:item_display,tag=ER.animal.model,tag=this]\r\nentity  thisEntity          is      @s\r\nscore   isMotionExist       is      #motionExist ER.sys\r\nscore   cooltime            is      #cooltime ER.sys\r\n\r\nimport animal:ready_anim_play   is animated_java:animal_alpha/animations/ready/play\r\nimport animal:ready_anim_stop   is animated_java:animal_alpha/animations/ready/stop\r\nimport animal:skill_anim_play   is animated_java:animal_alpha/animations/skill/play\r\nimport animal:skill_anim_stop   is animated_java:animal_alpha/animations/skill/stop\r\nimport animal:attack_anim_play  is animated_java:animal_alpha/animations/attack/play\r\nimport animal:attack_anim_stop  is animated_java:animal_alpha/animations/attack/stop\r\nimport animal:move_anim_play    is animated_java:animal_alpha/animations/move/play\r\nimport animal:move_anim_stop    is animated_java:animal_alpha/animations/move/stop\r\n\r\ndef    animal:skill             is eternal_return:entity/animal/alpha/skill\r\n\r\n#공격 대상 얻어오기\r\nexecute on target run tag @s add targeted\r\n\r\n#Motion 얻어오기\r\nexecute store result score #x ER.sys run data get entity @s Motion[0] 1000000\r\nexecute store result score #y ER.sys run data get entity @s Motion[1] 1000000\r\nexecute store result score #z ER.sys run data get entity @s Motion[2] 1000000\r\n\r\n#얻어온 Motion에 따른 isMotionExist 판정\r\nset #motionExist ER.sys 1\r\nif score #x ER.sys == 0 if score #y ER.sys == 0 if score #z ER.sys == 0 run\\\r\n    set #motionExist ER.sys 0\r\n\r\n#쿨타임 저장\r\nop #cooltime ER.sys = @s ER.cooltime\r\n\r\nexecute positioned as @s on passengers :\r\n\r\n    #> ON modelEntity\r\n    #ready 애니메이션 종료\r\n    if entity @s[tag= aj.animal_alpha.animation.ready.playing] run\\\r\n        function animal:ready_anim_stop\r\n    \r\n    #ATTACK & MOVE cooltime >= 100 까지\r\n    if cooltime == 1.. run goto:\r\n\r\n\r\n        # 플레이어 방향으로 시선 고정\r\n        rotate @s facing entity @p[tag=targeted,distance=..20]\r\n        data modify entity @s Rotation[1] set value 0.0f\r\n\r\n        #> ON rootEntity\r\n        # 쿨타임 제거 및 isMotionExist 처리\r\n        execute on vehicle run\\\r\n            sub @s ER.cooltime 1\r\n\r\n        #> ON rootEntity\r\n        #공격 중에 실행되는 부분\r\n        if entity @s[tag= aj.animal_alpha.animation.attack.playing] run goto:\r\n            \r\n            execute on vehicle :\r\n                thisEntity nbt Motion = [0.0d,0.0d,0.0d]\r\n                isMotionExist = 0\r\n\r\n            if score @s aj.attack.frame = #ER.animal.alpha.attack_tick_first ER.sys run return run\\\r\n                damage @p[tag=targeted, distance=..4] 5 minecraft:player_attack\r\n\r\n            if score @s aj.attack.frame = #ER.animal.alpha.attack_tick_second ER.sys run return run\\\r\n                damage @p[tag=targeted, distance=..4] 5 minecraft:player_attack\r\n\r\n        #> ON rootEntity\r\n        #공격 시작 조건\r\n        if entity @s[tag=!aj.animal_alpha.animation.attack.playing] if entity @p[tag=targeted, distance=..4] run goto:       \r\n            if entity @s[tag=aj.animal_alpha.animation.move.playing] run\\\r\n                function animal:move_anim_stop\r\n            function animal:attack_anim_play\r\n\r\n        ##> ELSE\r\n        #isMotionExist 가 0일 시 MOVE 애니메이션 종료\r\n        if isMotionExist == 0 if entity @s[tag= aj.animal_alpha.animation.move.playing] run return run\\\r\n            function animal:move_anim_stop\r\n        \r\n        #모든 애니메이션이 실행 중이 아닌 경우 MOVE 애니메이션 실행 (스킬 사용 중 제외)\r\n        if isMotionExist == 1 if entity @s[\\\r\n        tag=!aj.animal_alpha.animation.move.playing,\\\r\n        tag=!aj.animal_alpha.animation.attack.playing,\\\r\n        tag=!aj.animal_alpha.animation.skill.playing] run return run\\\r\n            function animal:move_anim_play\r\n        \r\n    #======# 0틱 때 스킬 발동\r\n\r\n    if cooltime == 0 :\r\n        # 스킬 발동 중\r\n        if entity @s[tag= aj.animal_alpha.animation.skill.playing] run goto:\r\n            # 이 이후로는 애니메이션 프레임에 따라 행동이 달라짐\r\n            #   +-------------------------------------+-------------------------------------------------------+\r\n            #   |           aj.skill.frame            |                       behaviour                       |\r\n            #   +-------------------------------------+-------------------------------------------------------+                  \r\n            #   | ER.animal.alpha.skill_effect_tick   |  스킬 효과 발동 (ex : 곰의 지면 강타, 멧돼지의 날리기 등) \r\n            #   | ER.animal.alpha.skill_end_tick      |  스킬 종료\r\n            #   +-------------------------------------+-------------------------------------------------------+\r\n\r\n            # 스킬 효과 발동\r\n            if score @s aj.skill.frame = #ER.animal.alpha.skill_effect_tick ER.sys on vehicle :\r\n                function animal:skill\r\n            \r\n            # 스킬 종료\r\n            if score @s aj.skill.frame = #ER.animal.alpha.skill_end_tick ER.sys on vehicle :\r\n                effect clear @s minecraft:slowness\r\n                thisEntity score ER.cooltime = 200\r\n        \r\n        # 스킬 시작\r\n        if entity @s[tag=aj.animal_alpha.animation.move.playing] run\\\r\n            function animal:move_anim_stop\r\n        if entity @s[tag=aj.animal_alpha.animation.attack.playing] run\\\r\n            function animal:attack_anim_stop\r\n        \r\n        function animal:skill_anim_play\r\n        execute on vehicle run effect give @s minecraft:slowness infinite 10\r\n            \r\n        \r\n\r\nexecute on target run tag @s remove targeted\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/../improved_mcfunction/project/eternal_return/entity/animal/alpha/behav.mcfunction b/../improved_mcfunction/project/eternal_return/entity/animal/alpha/behav.mcfunction
--- a/../improved_mcfunction/project/eternal_return/entity/animal/alpha/behav.mcfunction	(revision 759182b353c8c47f0555cd9661aeec180ee1106d)
+++ b/../improved_mcfunction/project/eternal_return/entity/animal/alpha/behav.mcfunction	(date 1739647841151)
@@ -87,6 +87,7 @@
         if entity @s[tag=!aj.animal_alpha.animation.attack.playing] if entity @p[tag=targeted, distance=..4] run goto:       
             if entity @s[tag=aj.animal_alpha.animation.move.playing] run\
                 function animal:move_anim_stop
+            #else
             function animal:attack_anim_play
 
         ##> ELSE
Index: ../improved_mcfunction/project/eternal_return/entity/animal/alpha/script.mcfunction
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>#> 알파 스크립트\r\nscore     selfID       is    @s df_id\r\nscore     thisHP       is    #this.HP ER.sys\r\nscore     thisMaxHP    is    #this.MaxHP ER.sys\r\nscore     thisAI       is    #this.AI ER.sys\r\nstorage   IDtemp       is    minecraft:temp temp\r\n\r\n\r\n#> 아이디 체크 및 동일한 아이디의 구성 엔티티에게 this 태그 부여\r\nIDtemp.id = selfID\r\ntag @s add this\r\nexecute on passengers run tag @s add this\r\nop #this.id ER.sys = @s df_id\r\nexecute as @e[type=minecraft:ghast, tag=ER.animal.hitbox] if score @s df_id = #this.id ER.sys:\r\n    tag @s add this\r\n    execute on passengers run tag @s add this\r\n\r\n#> 엔티티 매크로\r\nentity hitBoxEntity is @e[type=minecraft:ghast       ,tag=ER.animal.hitbox, tag=this, limit=1] \r\nentity modelEntity  is @e[type=minecraft:item_display,tag=ER.animal.model , tag=this, limit=1] \r\nentity hpBarEntity  is @e[type=minecraft:text_display,tag=ER.animal.HPbar , tag=this, limit=1] \r\nentity rootEntity   is @e[type=minecraft:husk        ,tag=ER.animal.root  , tag=this, limit=1] \r\nentity thisEntity   is @s\r\n\r\n# thisHP : 루트 엔티티가 갖고 있는 체력값 : 최대체력\r\n# thisMaxHP : 히트박스 엔티티가 갖고 있는 체력값 : 현재 체력\r\nthisHP    = hitBoxEntity score ER.health\r\nthisMaxHP = thisEntity   score ER.health\r\n\r\n\r\n\r\n\r\n\r\n#> AI 체크\r\nset #this.AI ER.sys 1\r\nif data entity @s {NoAI:1b} run set #this.AI ER.sys 0\r\n\r\n\r\n##> 최적화 [엔티티 쇼 / 노쇼]\r\n#function eternal_return:entity/animal/alpha/optimize/main\r\n\r\n\r\n#> 엔티티의 행동\r\n#> HP > 0\r\nif thisHP == 1..:\r\n    \r\n    if thisAI == 1 run return run\\\r\n        function eternal_return:entity/animal/alpha/behav/main\r\n\r\n    if thisAI == 0:\r\n        # 체력이 최대 체력 미만인 경우 AI -> true\r\n        if thisHP < thisMaxHP : \r\n            data modify entity @s NoAI set value 0b\r\n            set #this.AI ER.sys 1\r\n        \r\n        # 플레이어가 근처에 가면 발동 -> ready 애니메이션\r\n        execute positioned as @s \\\r\n        if entity @p[distance=0..6] \\\r\n        if score #this.HP ER.sys = #this.MaxHP ER.sys \\\r\n        as modelEntity[tag=!aj.animal_alpha.animation.ready.playing] run\\\r\n            function animated_java:animal_alpha/animations/ready/play\r\n\r\n    \r\n\r\n\r\n#DEATH()\r\n#> HP <= 0\r\nif thisHP == ..0 :\r\n    if score #this.AI ER.sys == 1 run\\\r\n        data modify entity @s NoAI set value 1b\r\n\r\n    execute on passengers if entity @s[tag=this]:\r\n        if entity @s[type=minecraft:item_display, tag= aj.animal_alpha.animation.death.playing,\\\r\n                    tag= ER.animal.model,scores = {aj.death.frame = 30}] run goto :\r\n            \r\n            execute on vehicle run kill @s\r\n            kill @e[type=minecraft:ghast,        tag=ER.animal.hitbox, tag=this] \r\n            kill @e[type=minecraft:text_display, tag=ER.animal.HPbar , tag=this] \r\n            function animated_java:animal_alpha/remove/this\r\n\r\n            execute as @e[type=minecraft:item] :\r\n                if data entity @s {Item:{id:\"minecraft:rotten_flesh\"}} run return run kill @s\r\n                if data entity @s {Item:{id:\"minecraft:gunpowder\"}}    run return run kill @s\r\n                if data entity @s {Item:{id:\"minecraft:ghast_tear\"}}   run return run kill @s\r\n            \r\n            kill @e[type=minecraft:experience_orb]\r\n\r\n        if entity @s[type=minecraft:item_display, tag= ER.animal.model, tag= !aj.animal_alpha.animation.death.playing]:\r\n            function animated_java:animal_alpha/animations/attack/stop\r\n            function animated_java:animal_alpha/animations/move/stop\r\n            function animated_java:animal_alpha/animations/skill/stop\r\n            function animated_java:animal_alpha/animations/death/play\r\n\r\n# 히트박스 위치 조정\r\nhitBoxEntity nbt Pos = thisEntity nbt Pos\r\ntag @e[tag=ER.animal, tag=this] remove this\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/../improved_mcfunction/project/eternal_return/entity/animal/alpha/script.mcfunction b/../improved_mcfunction/project/eternal_return/entity/animal/alpha/script.mcfunction
--- a/../improved_mcfunction/project/eternal_return/entity/animal/alpha/script.mcfunction	(revision 759182b353c8c47f0555cd9661aeec180ee1106d)
+++ b/../improved_mcfunction/project/eternal_return/entity/animal/alpha/script.mcfunction	(date 1739648172205)
@@ -35,14 +35,13 @@
 set #this.AI ER.sys 1
 if data entity @s {NoAI:1b} run set #this.AI ER.sys 0
 
-
-##> 최적화 [엔티티 쇼 / 노쇼]
-#function eternal_return:entity/animal/alpha/optimize/main
-
+##> 히트박스 위치 조정
+hitBoxEntity nbt Pos = thisEntity nbt Pos
+tag @e[tag=ER.animal, tag=this] remove this
 
 #> 엔티티의 행동
 #> HP > 0
-if thisHP == 1..:
+if thisHP == 1.. run goto:
     
     if thisAI == 1 run return run\
         function eternal_return:entity/animal/alpha/behav/main
@@ -69,7 +68,8 @@
     if score #this.AI ER.sys == 1 run\
         data modify entity @s NoAI set value 1b
 
-    execute on passengers if entity @s[tag=this]:
+    execute on passengers\
+    if entity @s[tag=this]:
         if entity @s[type=minecraft:item_display, tag= aj.animal_alpha.animation.death.playing,\
                     tag= ER.animal.model,scores = {aj.death.frame = 30}] run goto :
             
@@ -91,6 +91,4 @@
             function animated_java:animal_alpha/animations/skill/stop
             function animated_java:animal_alpha/animations/death/play
 
-# 히트박스 위치 조정
-hitBoxEntity nbt Pos = thisEntity nbt Pos
-tag @e[tag=ER.animal, tag=this] remove this
+
